(()=>{"use strict";const e=document.querySelector("#time"),t=document.querySelector(".date");function n(o){const r=(new Date).toLocaleTimeString();e.textContent=`${r}`,setTimeout((()=>{n(),function(e){const n=new Date,o={weekday:"long",month:"long",day:"numeric"};if("en"===e){const e=n.toLocaleDateString("en-US",o);t.textContent=`${e}`}if("ru"===e){const e=n.toLocaleDateString("ru-RU",o);t.textContent=`${e}`}}(o)}),1e3)}const o={morning:{en:"Good morning,",ru:"Доброе утро,"},afternoon:{en:"Good afternoon,",ru:"Добрый день,"},evening:{en:"Good evening,",ru:"Добрый вечер,"},night:{en:"Good night,",ru:"Спокойной ночи,"}},r=document.querySelector(".greeting"),c=document.querySelector(".name");function a(){let e=(new Date).getHours();return e>=6&&e<12?"morning":e>=12&&e<18?"afternoon":e>=18&&e<24?"evening":e>=0&&e<6?"night":void 0}function l(e){const t=a();r.innerHTML=o[t][e],"ru"===e?c.setAttribute("placeholder","[Введите имя]"):c.setAttribute("placeholder","[Enter name]")}document.querySelector(".en"),document.querySelector(".ru");const s=document.querySelector(".body"),i=document.querySelector(".slide-next"),u=document.querySelector(".slide-prev"),d=document.querySelector(".unsplash"),m=document.querySelector(".github"),y=document.querySelector(".flickr");let g,f,h=!1,p=!1,S=!1;async function v(e){const t=new Image,n=a();t.src=`https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${n}/${e}.jpg`,t.onload=()=>{s.style.backgroundImage=`url(${t.src})`}}function q(){var e,t;h=!h,v((e=1,t=20,e=Math.ceil(e),t=Math.floor(t),g=Math.floor(Math.random()*(t-e+1))+e,g).toString().padStart(2,"0"))}async function w(){const e=new Image,t=`https://api.unsplash.com/photos/random?query=${a()}&client_id=C1S6YCrZfOiSdwG0MkvilXFoSA07PbXGVKkVLNfAb6E`,n=await fetch(t),o=await n.json();e.src=o.urls.regular,e.onload=()=>{s.style.backgroundImage=`url(${e.src})`}}async function E(e){const t=new Image,n=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=f796ef77418cdd74e342ac3a1892461f&tags=${a()}&extras=url_l&format=json&nojsoncallback=1`,o=await fetch(n),r=await o.json();for(let e=0;e<r.photos.photo.length;e++)t.src=r.photos.photo[e].url_l;t.onload=()=>{s.style.backgroundImage=`url(${t.src})`}}m.addEventListener("click",(()=>{q(),h=!0,p=!1,S=!1})),d.addEventListener("click",(()=>{w(),S=!0,p=!1,h=!1})),y.addEventListener("click",(()=>{E(),p=!p,h=!1,S=!1})),i.addEventListener("click",(()=>{!0===p&&async function(){console.log(p),f++,await E()}(),!0===h&&(g++,g>20&&(g=1),v(g.toString().padStart(2,"0"))),!0===S&&w()})),u.addEventListener("click",(()=>{!0===p&&async function(){console.log(p),f--,f<1&&(f=99),await E()}(),!0===h&&(g--,g<1&&(g=20),v(g.toString().padStart(2,"0"))),!0===S&&w()}));const L=document.querySelector(".weather-icon"),k=document.querySelector(".temperature"),$=document.querySelector(".weather-description"),b=document.querySelector(".wind"),x=document.querySelector(".humidity"),C=document.querySelector(".weather-error"),A=async function(e,t){const n=`https://api.openweathermap.org/data/2.5/weather?q=${e}&lang=${t}&appid=bd09335c53afb6c7e669e2f8a2de2400&units=metric`,o=await fetch(n),r=await o.json();400!==o.status&&404!==o.status||(C.textContent=`Error! ${r.message} for ${city.value}!`,L.classList.remove(),k.textContent="",$.textContent="",b.textContent="",x.textContent=""),L.classList="weather-icon owf",L.classList.add(`owf-${r.weather[0].id}`),k.textContent=`${Math.floor(r.main.temp)}°C`,$.textContent=r.weather[0].description,b.textContent=`Wind speed: ${Math.floor(r.wind.speed)}m/s`,x.textContent=`Humidity: ${Math.floor(r.main.humidity)}%`,C.textContent="","ru"===t&&(b.textContent=`Cкорость ветра: ${Math.floor(r.wind.speed)}m/s`,x.textContent=`Влажность: ${Math.floor(r.main.humidity)}%`)},M=document.querySelector(".quotes"),I=document.querySelector(".author"),D=document.querySelector(".change-quote"),T=document.querySelectorAll(".translate-btn ");let j;async function G(){const e=await fetch("../assets/data.json");return await e.json()}async function W(e){const t=(await G())[j];"ru"===e?(M.textContent=`${t.ru.text}`,I.textContent=`${t.ru.author}`):"en"===e&&(M.textContent=`${t.en.text}`,I.textContent=`${t.en.author}`)}D.addEventListener("click",(async()=>{await async function(){j++,j>6&&(j=1);for(let e of T)e.classList.contains("color")&&W(e.textContent)}()}));const H=[{title:"Aqua Caelestis",src:"../assets/sounds/Aqua Caelestis.mp3",duration:""},{title:"Ennio Morricone",src:"../assets/sounds/Ennio Morricone.mp3",duration:""},{title:"River Flows In You",src:"../assets/sounds/River Flows In You.mp3",duration:""},{title:"Summer Wind",src:"../assets/sounds/Summer Wind.mp3",duration:""}],_=document.querySelector(".play"),F=document.querySelector(".play-next"),R=document.querySelector(".play-prev"),X=document.querySelector(".play-list"),Y=document.querySelector(".player-timer");let P=!1,U=0;const V=new Audio;function K(){U++,U===H.length&&(U=0),V.src=H[U].src,V.play(),N()}function N(){document.querySelectorAll(".play-item").forEach((e=>{H[U].title===e.textContent?e.classList.add("item-active"):e.classList.remove("item-active")})),J.textContent=`${H[U].title}`}const O=document.querySelector(".progress"),Q=document.querySelector(".progress-volume"),Z=document.querySelector(".progress-volume"),z=document.querySelector(".mute"),B=document.querySelector(".volume-icon"),J=document.querySelector(".player-title");function ee(){Q.addEventListener("input",(function(){V.volume=this.value;const e=100*this.value;this.style.background=`linear-gradient(to right, #AE25DE 0%, #AE25DE ${e}%, #fff ${e}%, white 100%)`,0===e?(z.style.display="block",B.style.display="none"):(z.style.display="none",B.style.display="block")}))}function te(e){let t=Math.floor(e/60),n=e-60*t,o=Math.floor(n);return`${t}:${o>9?o:`0${o}`}`}function ne(e){const t=e.offsetX/O.offsetWidth*V.duration;V.currentTime=t}Z.addEventListener("change",ee),Z.addEventListener("mousemove",ee);let oe=!1;B.addEventListener("click",(function(){V.volume=0,z.style.display="block",B.style.display="none",oe=!oe})),z.addEventListener("click",(function(){oe=oe,V.volume=Z.value,z.style.display="none",B.style.display="block"})),V.addEventListener("timeupdate",(function(){const e=V.currentTime/V.duration*100;O.value=e,O.style.background=`linear-gradient(to right, #AE25DE 0%, #AE25DE ${e}%, #fff ${e}%, white 100%)`,Y.textContent=te(V.currentTime)+" / "+te(V.duration)})),V.addEventListener("ended",(function(){V.currentTime=0}),!1);let re=!1;O.addEventListener("click",ne),O.addEventListener("mousemove",(e=>re&&ne(e))),O.addEventListener("mousedown",(()=>re=!0)),O.addEventListener("mouseup",(()=>re=!1)),_.addEventListener("click",(function(){V.src=H[U].src,V.currentTime=0,V.setAttribute("autoplay","autoplay"),P=!P,P?(V.play(),_.classList.add("pause"),N()):(V.pause(),P=!1,_.classList.remove("pause"))})),F.addEventListener("click",K),R.addEventListener("click",(function(){0===U&&(U=H.length),U--,V.src=H[U].src,V.play(),N()})),V.addEventListener("ended",K);const ce={lang:{en:"Language",ru:"Язык"},background:{en:"Choose background",ru:"Выбрать фон"},hidden:{en:"Hide / Show",ru:"Показать / Скрыть"},links:{en:"Links",ru:"Ссылки"},time:{en:"Time",ru:"Время"},date:{en:"Date",ru:"Дата"},greeting:{en:"Greeting",ru:"Приветствие"},quotes:{en:"Quotes",ru:"Цитаты"},weather:{en:"Weather",ru:"Погода"},player:{en:"Player",ru:"Плеер"}},ae=document.querySelectorAll(".setting-view"),le=document.querySelector(".setting-modal"),se=document.querySelector(".toggle"),ie=document.querySelectorAll(".background-btn");function ue(e){for(let t in ce)document.querySelector(`.lng-${t}`).textContent=ce[t][e]}document.querySelectorAll(".translate-btn"),document.querySelector(".hide");let de=!1,me=!1;se.addEventListener("click",(()=>{de=!de,!0===de&&(le.style.display="block"),!1===de&&(le.style.display="none")})),ie.forEach((e=>{e.addEventListener("click",(()=>{de=!de,le.style.display="none"}))})),ie.forEach((e=>{e.addEventListener("click",(e=>{me=!me,function(e){const t=["time","date","greeting","quote","weather","player","links"];for(let n of t){if(me&&e.target===document.querySelector(`.background-btn.lng-${n}`))return document.querySelector(`.${n}`).classList.add("hidden-block"),console.log(n),n;me||e.target!==document.querySelector(`.background-btn.lng-${n}`)||document.querySelector(`.${n}`).classList.remove("hidden-block")}}(e)}))}));const ye=document.querySelector(".name"),ge=document.querySelector(".city"),fe=document.querySelectorAll(".en"),he=document.querySelectorAll(".ru");let pe="Minsk",Se="en";n(Se),function(){const e=`Good ${a()},`;r.textContent=e}(),q(),A(pe,Se),async function(e){const t=await async function(){const e=await G(),t=Math.floor(Math.random()*e.length);return j=t,t}(),n=(await G())[t];M.textContent=`${n.en.text}`,I.textContent=`${n.en.author}`}(),function(){for(let e of H){const t=document.createElement("li");t.classList.add("play-item"),t.textContent=`${e.title}`,X.append(t)}}(),document.querySelectorAll(".nav-list li").forEach(((e,t)=>{e.onmouseenter=()=>{ae[t].style.display="block",t>0&&t<2&&(ae[t].previousElementSibling.style.display="none",ae[t].nextElementSibling.style.display="none"),0===t&&(ae[t].nextElementSibling.style.display="none"),t===ae.length-1&&(ae[t].previousElementSibling.style.display="none",ae[0].style.display="none")}})),ge.addEventListener("change",(()=>{A(ge.value)})),fe.forEach((e=>{e.addEventListener("click",(e=>{l("en"),A(ge.value,"en"),n("en"),W("en"),ue("en"),e.target.classList.add("color"),he.forEach((e=>{e.classList.remove("color")}))}))})),he.forEach((e=>{e.addEventListener("click",(e=>{l("ru"),A(ge.value,"ru"),n("ru"),W("ru"),ue("ru"),e.target.classList.add("color"),fe.forEach((e=>{e.classList.remove("color")}))}))})),window.addEventListener("beforeunload",(function(){localStorage.setItem("name",ye.value),localStorage.setItem("city",ge.value)})),window.addEventListener("load",(async function(){localStorage.getItem("name")&&(ye.value=localStorage.getItem("name")),localStorage.getItem("city")&&(ge.value=localStorage.getItem("city"),pe=ge.value,await A(ge.value))}))})();